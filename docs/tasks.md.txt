# BJARNE TASKS
_Last reviewed: 2025-12-05_

## Active
- [ ] Test MSan with real-world code generation scenarios
- [ ] Verify 15-attempt escalation works correctly

## Backlog
- [ ] `/init` command - Workspace indexing for codebase context
  - Scan current folder and subdirectories
  - Process all source files (.cpp, .h, .c, .hpp)
  - Create index of: functions, classes, structs, includes, dependencies
  - Storage options to evaluate:
    - bjarne.index.json (simple, portable)
    - SQLite (queryable, scales better)
    - Embedded DB (bbolt, badger)
  - Goal: Pull relevant context when user asks for code that integrates with existing codebase
  - Similar to Claude Code's codebase indexing
  - Consider: file hashes for incremental updates, AST parsing vs regex

- [ ] Multi-provider LLM support (beyond Bedrock)
  - Anthropic API direct (claude.ai)
    - Claude Haiku, Sonnet, Opus (same models, direct API)
  - OpenAI API
    - GPT-5.1 (general reasoning)
    - GPT-5.1-Codex-Max (agentic coding, long-horizon tasks, context compaction)
    - Reasoning effort levels: medium, high, xhigh
  - Google Gemini API
    - Gemini 3 Pro
  - Config: BJARNE_PROVIDER=bedrock|anthropic|openai|gemini
  - Config: BJARNE_API_KEY for non-Bedrock providers
  - Abstract LLM interface: Generate(ctx, model, system, messages, maxTokens)
  - Model mapping per provider:
    - "haiku" -> claude-3-5-haiku / gpt-5.1 / gemini-3-pro
    - "sonnet" -> claude-3-5-sonnet / gpt-5.1 / gemini-3-pro
    - "opus" -> claude-opus-4 / gpt-5.1-codex-max / gemini-3-pro
  - Note: GPT-5.1-Codex-Max supports multi-hour autonomous sessions with context
    compaction over millions of tokens - ideal for complex refactors

- [ ] Easy installation / distribution
  - Goal: `something install -g bjarne` that just works
  - Options to evaluate:
    - `go install github.com/3rg0n/bjarne@latest` (Go users only)
    - Homebrew tap (macOS/Linux): `brew install 3rg0n/tap/bjarne`
    - Scoop bucket (Windows): `scoop install bjarne`
    - npm wrapper package (cross-platform): `npm install -g bjarne`
    - goreleaser for GitHub Releases with pre-built binaries
  - Post-install script should:
    - Check for podman/docker, warn if missing
    - Offer to pull bjarne-validator container
    - Create default config if needed
  - Publish container to ghcr.io/3rg0n/bjarne-validator:latest

- [ ] Collapsible code blocks with mouse interaction (requires alt screen mode)
- [ ] Multi-file project support (header + implementation)
- [ ] Property-based testing with FuzzTest
- [ ] Domain-specific validators (HFT, embedded, gamedev)
- [ ] Benchmark gate for performance-sensitive code
- [ ] CI/CD integration - GitHub Action for bjarne validation

## Completed
- [x] MSan support with instrumented libc++
- [x] 15-attempt escalation with clear thresholds
- [x] Improved fix prompts with sanitizer guidance
- [x] LLM now receives full code + errors during fix iterations
- [x] Question detection for EASY tasks
- [x] Safe C functions rules in generation prompt
- [x] Code reveal animation

---

### Rules
- Keep 1-3 items active (WIP <= 3)
- When done:
  1. Commit with descriptive message
  2. Move to Completed section

> This file reflects *now*, not history. Use Git for history.
